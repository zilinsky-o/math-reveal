<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Math Picture Reveal Game</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="version-info">v2.1.0</div>

    <div class="test-panel" id="test-panel">
        <h3>ğŸ”§ Test Panel</h3>
        <button class="test-button" onclick="revealAll()">Reveal All & End</button>
        <button class="test-button" onclick="viewCollection()">View Collection</button>
        <div style="margin-top: 0.5rem;">
            <label style="color: #f00; font-weight: bold; margin-right: 0.5rem;">Add Collectible:</label>
            <br>
            <select id="collectible-selector" style="padding: 0.5rem; border-radius: 0.25rem; border: 1px solid #f00; font-family: 'Comic Sans MS', cursive; font-weight: bold; margin-top: 0.25rem; width: 200px;">
            </select>
            <button class="test-button" onclick="addTestCollectible()" style="margin-left: 0.5rem; margin-top: 0.25rem;">Add to Collection</button>
        </div>
        <div style="margin-top: 0.5rem;">
            <label style="color: #f00; font-weight: bold; margin-right: 0.5rem;">Jump to:</label>
            <select id="level-selector" onchange="jumpToLevel(parseInt(this.value))" style="padding: 0.5rem; border-radius: 0.25rem; border: 1px solid #f00; font-family: 'Comic Sans MS', cursive; font-weight: bold;">
                <option value="1">Level 1</option>
                <option value="2">Level 2</option>
                <option value="3">Level 3 (Pathfinding)</option>
                <option value="4">Level 4</option>
                <option value="5">Level 5</option>
                <option value="6">Level 6 (Boss)</option>
            </select>
        </div>
    </div>

    <div class="level-intro" id="level-intro">
        <div class="level-intro-content">
            <div id="boss-intro-emoji" style="font-size: 8rem; margin: 1rem 0; display: none;">ğŸ‘¹</div>
            <h1 id="level-intro-title">LEVEL 1</h1>
            <p id="level-intro-desc">Practice Addition!</p>
            <button class="start-level-button" onclick="startLevel()">START</button>
        </div>
    </div>

    <div class="level-intro" id="boss-loss-modal" style="display: none;">
        <div class="level-intro-content">
            <div style="font-size: 8rem; margin: 1rem 0;">ğŸ’€</div>
            <h1 style="background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">DEFEATED!</h1>
            <p style="font-size: 1.5rem; color: #dc2626; margin-bottom: 2rem;">The boss reached you!</p>
            <button class="start-level-button" onclick="restartFromBossLoss()" style="background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);">TRY AGAIN</button>
        </div>
    </div>

    <div class="collection-modal" id="collection-modal">
        <div class="collection-content">
            <div class="collection-header">
                <h2>ğŸ¨ My Collection</h2>
                <button class="close-button" onclick="closeCollection()">Ã—</button>
            </div>
            <div class="collection-grid" id="collection-grid"></div>
        </div>
    </div>

    <div class="container">
        <div class="header">
            <div class="level-badge" id="level-badge">Level 1</div>
            <h1>Math Picture Reveal! âœ¨</h1>
            <div class="progress-bar">
                <div class="progress">
                    <p id="progress-text">0/64 Cells Discovered!</p>
                </div>
                <div class="mistakes">
                    <p id="mistakes-text">Mistakes: 0</p>
                </div>
                <div class="collection-badge" onclick="viewCollection()">
                    <p id="collection-count">ğŸ“š Collection: 0</p>
                </div>
                <button class="pause-button" id="pause-button" onclick="togglePause()">â¸ï¸ Pause</button>
                <button class="restart-button" onclick="restartGame()">ğŸ”„ Restart</button>
            </div>
        </div>

        <div class="main-content">
            <div class="collectibles-pane" id="collectibles-pane">
                <h3>ğŸ¨ Collection</h3>
                <div class="collectibles-grid" id="collectibles-pane-grid"></div>
            </div>

            <div class="game-area">
                <div class="boss-arena" id="boss-arena" style="display: none;">
                    <div class="boss-progress-bar">
                        <div class="boss-progress-fill" id="boss-progress-fill" style="width: 50%;">
                            Boss Position
                        </div>
                    </div>
                    <div class="boss-danger-zone" id="boss-danger-zone"></div>
                    <div class="boss-avatar" id="boss-avatar">ğŸ§™</div>
                    <div class="boss-character" id="boss-character" style="left: 50%;">ğŸ‘¹</div>
                    <div class="boss-prison" id="boss-prison" style="display: flex; align-items: center; justify-content: center; position: relative;">
                        <div style="font-size: 50px; position: absolute; color: #dc2626; font-weight: bold; letter-spacing: 5px; text-shadow: 2px 2px 4px rgba(0,0,0,0.8);">| | | | |</div>
                        <div style="font-size: 80px; position: absolute; margin-top: -20px;">ğŸ”’</div>
                    </div>
                    <div class="boss-ball" id="boss-bomb">ğŸ’£</div>
                    <div class="boss-ball" id="boss-explosion" style="font-size: 60px;">ğŸ’¥</div>
                    <div class="boss-ground"></div>
                </div>

                <div class="pathfinding-arena" id="pathfinding-arena" style="display: none;">
                    <div class="pathfinding-grid" id="pathfinding-grid"></div>
                    <div class="pathfinding-avatar" id="pathfinding-avatar">ğŸ§™</div>
                    <div class="pathfinding-chest" id="pathfinding-chest">ğŸ</div>
                </div>

                <div class="game-board" id="game-board">
                    <div class="background" id="background">
                        <div class="emoji" id="emoji">ğŸ¦„</div>
                    </div>
                    <div class="grid-overlay" id="grid"></div>
                </div>
            </div>

            <div class="question-box" id="question-box">
                <div class="paused-overlay" id="paused-overlay">
                    <div class="paused-text">â¸ï¸ Paused</div>
                </div>
                <div class="timer" id="timer">0s</div>
                <div class="question" id="question">What is 2 + 2?</div>
                <input type="number" class="answer-input" id="answer-input" autofocus>
                <br>
                <button class="check-button" onclick="checkAnswer()">Check Answer!</button>
                <div class="feedback" id="feedback"></div>
            </div>
        </div>

        <div class="completion" id="completion" style="display: none;">
            <h2>ğŸ‰ Amazing Work! ğŸ‰</h2>
            <p id="completion-text">You revealed the Unicorn!</p>
            <div class="new-collectible" id="new-collectible">ğŸ¦„</div>
            <p style="color: #8b5cf6; font-size: 1.3rem; font-weight: bold;">Added to your collection!</p>
            <button class="next-level-button" id="next-level-button" onclick="goToNextLevel()">Next Level â†’</button>
            <div id="reports-container"></div>
        </div>
    </div>

    <!-- JavaScript files in dependency order -->
    <script src="config.js"></script>
    <script src="storage.js"></script>
    <script src="audio.js"></script>
    <script src="boss.js"></script>
    <script src="test-mode.js"></script>
    <script src="game.js"></script>
</body>
</html>
